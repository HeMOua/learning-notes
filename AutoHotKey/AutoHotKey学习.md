# AutoHotKey学习

## 语法

### 1.常规约定

+ 名称：变量和函数不区分大小写
+ 无类型变量：变量类型是动态的，没有显示定义
+ 空格：
  + 通常可以忽略，但有时可能导致错误
  + 函数名和()之间不能有空格
  + 在代码后面进行注释时，需要加空格
+ 语句结束：像 python 一样，语句结束没有任何符号

### 2.运算符

+ 采用符号或符号组的形式，如 `+` 、 `:=`  等
  + `:=` 用来赋值
+ 单词 `and`, `or`, `not`, `is`, `in` 或 `contains`

### 3.注释

单行注释

```autohotkey
;注释
```

多行注释

```
/*
多行注释
*/

/* 这也是有效注释, 但是这一行不能有其他代码. */
```

除了制表符和空格, `/*` 必须出现在行首, 而 `*/` 只能出现在行首或行尾. 省略 `*/` 也是有效的, 在这种情况下, 文件的其余部分将被注释掉.

## 数据类型

Autohotkey 支持以下几类值

+ 字符串
+ 数字
+ 对象
+ 布尔值
+ 空值

### 字符串

+ 字符串只能使用 `""` 括起来

+ AutoHotkey 规定字符串第一个位置为 1

+ 字符串拼接

  + 方式一：使用空格隔开 

    ```
    a := "asdf" "asdf"
    ```

  + 方式二：使用 `.` 隔开

    ```
    a := "asdf" . "asdf"
    ```

+ 格式化字符串

  ```ahk
  a := Format("You are using AutoHotkey v{1} {2}-bit.", A_AhkVersion, A_PtrSize*8)
  ```

### 数字

AutoHotkey 支持这些数字格式:

- 十进制整数, 如 `123`, `00123` 或 `-1`.
- 十六进制整数, 如 `0x7B`, `0x007B` 或 `-0x1`.
- 十进制浮点数, 如 `3.14159`.

### 布尔值

+ *布尔值* 可以是 *true* 或 *false*.
  + 单词 `true` 和 `false` 是值分别为 1 和 0 的内置变量
+ 布尔值也可以表示 *yes* 或 *no*, *on* 或 *off*, *down* 或 *up*(如 [GetKeyState](https://wyagd001.github.io/v2/docs/lib/GetKeyState.htm))

### 空值

AutoHotkey 不支持传递空值，如果读取没有任何值的变量会直接报错

### 对象

包含任意数量的属性和方法

### 动态变量

```
target := 42
second := "target"
MsgBox  second   ; 普通(单重) 变量引用 => target
MsgBox %second%  ; 双重解引 => 42
```

可以通过字符串拼接来获取变量

## 函数

当然, 函数调用时也可以不保存其返回值:

```
Add(2, 3)
Add 2, 3  ; 如果在行的开头使用, 括号可以省略.
```

不过这种情况下, 函数的任何返回值都会被丢弃; 所以除非函数还有除了返回值之外的功能, 否则这次调用毫无意义.