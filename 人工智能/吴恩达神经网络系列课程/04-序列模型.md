# 循环序列模型

> 本章的知识点是循环神经网络。这种类型的模型已经被证明在时间数据上表现非常好，它有几个变体，包括 LSTM、GRU 和双向神经网络。

## 序列模型

循环神经网络 (RNN) 之类的模型，在语音识别、自然语言处理和其他领域中有重大意义，下面的这些例子都有效使用了序列模型

+ 在进行语音识别时，给定了一个输入音频片段X，并要求输出片段对应的文字记录Y，这个例子里输入和输出数据，都是序列数据，因为X是一个，按时序播放的音频片段，输出Y是一系列单词
+ 音乐生成问题，这个例子中，只有输出数据Y是序列，而输入数据可以是空集，也可以是个单一的整数，这个数可能指代，你想要生成的音乐风格，也可能是你想要生成的，那首曲子的头几个音符，无论怎样 输入的X可以是空的，或者就是个数字，然后输出序列Y，
+ 在处理情感分类时，输入数据X是序列，你会得到类似这样的输入，"There is nothing to like in this movie"，你认为这句评论对应几星?
+ DNA序列分析中也十分有用，你的DNA可以用 A C G T 四个字母来表示，所以给定一段DNA序列，希望模型够标记出哪部分是匹配某种蛋白质
+ 在机器翻译过程中，输入一段话voulez-vou chante avec moi? 然后要求你输出另一语言的翻译结果，
+ 在进行视频行为识别时，你可能会得到一系列视频帧，然后要求你识别其中的行为
+ 在进行命名实体识别时，可能会给定一个句子，要你识别出句中的人名

序列问题有很多不同类型，有些问题里输入数据X和输出数据Y都是序列，X和Y有时也会不一样长，又或者X和Y的有相同的数据长度，在另一些问题里，只有X或者只有Y是序列

## 数学符号

在上个视频中，你了解了一些，能够应用序列模型的例子，我们先从定义符号开始，一步步构建序列模型，比如说，你想要建立一个序列模型，它的输入语句是这样的，"Harry Potter and Hermione Granger invented a new spell."，顺便提一句这些人名都，出自于J.K. Rowling笔下的，系列小说Harry Potter，假如你想要建立一个，能够自动识别，句中人名位置的序列模型，那么这就是一个，命名实体识别问题，这常用于搜索引擎，比如说 索引过去24小时内，所有新闻报道提及的人名，用这种方式就能够恰当地进行索引，命名实体识别系统可以用来，查找不同类型的文本中的，人名 公司名 时间 地点，国家名 货币名等等，现在 给定这样的输入数据x，假如你想要一个序列模型输出y，使得输入的每个单词都对应一个输出值，同时这个y能够表明，输入的单词，是否是人名的一部分，技术上说，这也许不是最好的输出形式，还有更加复杂的输出形式，它不仅能够表明，输入词是否是人名的一部分，它还能够告诉你这个人名，在这个句子里从哪里开始到哪里结束，比如Harry Potter从这里开始，在这里结束 Hermione Granger在这里开始 在这里结束，不过对于这个例子，我会讲解，更简单的那种输出形式，这个输入数据是9个单词组成的序列，所以最终我们会有9个，特征集合来表示这9个单词，并按序列中的位置进行索引，我将用，X^<1> X^<2> X^<3>，等等一直到X^<t>，来索引不同的位置，我将用X^<t>来索引，这个序列的中间位置，t意味着它们是，时序序列，但不论是否是时序序列，我都将用t，来索引序列中的位置，输出数据也一样，我们还是用，y^<1> y^<2> y^<3>，等等一直到y^<9>来表示输出数据，同时我们用T_x，来表示输入序列的长度，这个例子中输入是9个单词，所以T_x就等于9，我们用T_y，来表示输出序列的长度，在这个例子里T_x就等于T_y，上个视频里你知道，T_x和T_y可以有不同的值，你应该记得，我们之前用的符号，我们是用X^(i)，来表示第i个训练样本，所以为了指代第t个元素，或者说是，训练样本 i 的序列中第 t 个元素，用X^(i)这个符号来表示，如果T_x是序列的长度，那么你的训练集里不同的训练样本，就会有不同的长度，所以T_x^(i)就代表，第i个训练样本的输入序列长度，同样 y^(i)，代表第i个训练样本中，第t个元素，T_y^(i)就是，第i个训练样本的输出序列的长度，所以在这个例子中，T_x^(i)就等于9，但如果另一个样本是，由15个单词组成的句子，那么对于这个训练样本，它的T_x^(i)就等于15，既然我们这个例子是，NLP也就是自然语言处理，这是我们初次涉足，自然语言处理，一件我们需要事先决定的事是，怎样表示，一个序列里单独的单词，你会怎样表示像Harry这样的单词，x_1实际应该是什么?，接下来我们讨论一下，怎样表示一个句子里单个的词，想要表示一个句子里的单词，第一件事是做一张词表，有时也称为词典，意思是列一列，你的表示方法中要用到的单词，这个词表中的第一个词是a，也就是说词典中的第一个单词是a，第二个单词是Aaron，然后更下面一些是单词and，再后面你会找到，Harry然后找到Potter，这样一直到最后，词典里最后一个单词可能是Zulu，因此a是第一个单词，Aaron是第二个单词，在我的词典里，and出现在第367这个位置上，Harry是在4075这个位置，Potter在6830，词典里的最后一个单词Zulu，可能是第10000个单词，所以这个例子中，我用了10000个单词大小的词典，这对现代自然语言处理应用来说太小了，对于商业应用来说，对于一般规模的商业应用来说，30000到50000词大小的词典比较常见，但是100000词的也不是没有，而且有些大型互联网公司，会用百万词，甚至更大的词典，你知道的，许多商业应用用的词典，可能是30000词也可能是50000词，不过我将用10000词大小的词典做说明，因为这是一个好用的整数，好 如果你选定了10000词的词典，构建这个词典的一个方法是，遍历你的训练集，并且找到前10000个常用词，你也可以去浏览，一些网络词典，它能告诉你英语里，最常用的10000个单词，接下来你可以用，One-hot 表示法，来表示词典里的每个单词，举个例子，在这里x^<1>表示Harry这个单词，它就是一个，第4075行是1  其余值都是0的向量，因为那是Harry在这词典里的位置，同样 x^<2>，是个第6830行是1，其余位置都是0的向量，and在词典里是排第367，所以x^<3>就是，第367行是1，其余值都是0的向量，如果你的词典大小是10000的话，那么这里每个向量都是10000维的，再看这个单词A，因为A是字典里第一个单词，x^<7>对应a，那就是向量1，它是第1个位置是1，其余位置都是0的向量，所以这种表示方法中，x^<t>指代句子里的任意词，它就是个one-hot向量，说它是one-hot是因为，它只有一个值是1，其余值都是0，所以你会有9个one-hot向量，来表示这个句中的9个单词，目的是用这样的表示方式表示X，用序列模型在X和目标输出Y之间，学习建立一个映射，我会把它当做监督学习的问题，我确信会给定带有 (x, y) 标签的数据，那么还剩最后一件事，我们将在之后的视频讨论，如果你遇到了一个，不在你的词表中的单词，答案就是，创建一个新的标记，也就是一个叫做Unknown Word的伪造单词，用<UNK>作为标记，来表示不在词表中的单词，我们之后会讨论更多有关这个的内容，总结一下本节视频的内容，我们描述了一套符号，用来表述你的训练集里的，序列数据x和y，在下节视频中，我们会开始讲述循环神经网络中



1.3 循环神经网络模型

1.4 通过时间的反向传播

1.5 不同类型的循环神经网络

1.6 语言模型和序列生成

1.7 对新序列采样

1.8 带有神经网络的梯度消失

1.9 GRU 单元

1.10 长短期记忆（LSTM）

1.11 双向神经网络

1.12 深层循环神经网络





**第二周 自然语言处理与词嵌入**



自然语言处理与深度学习是特别重要的组合。使用词向量表示和嵌入层，可以训练在各种行业中表现出色的循环神经网络。应用程序示例包括情绪分析、物体识别和机器翻译。



2.1 词汇表征

2.2 使用词嵌入

2.3 词嵌入的特性

2.4 嵌入矩阵

2.5 学习词嵌入

2.6 Word2Vec

2.7 负采样

2.8 GloVe 词向量

2.9 情绪分类

2.10 词嵌入除偏





**第三周 序列模型和注意力机制**



注意力机制可以增强序列模型。这个算法将帮助你的模型理解，在给出一系列的输入时，它应该把注意力放在什么地方。本周，你还将学习语音识别以及如何处理音频数据。



3.1 基础模型

3.2 选择最可能的句子

3.3 定向搜索

3.4 改进定向搜索

3.5 定向搜索的误差分析

3.6 Bleu 得分（选修）

3.7 注意力模型直观理解

3.8 注意力模型

3.9 语音辨识

3.10 触发字检测

3.11 结论和致谢